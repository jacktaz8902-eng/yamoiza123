<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>GPS ì²´í¬ì¸ - í‰ì°½ë™ ê°€ë‚˜ì•„íŠ¸ì„¼í„° (í…ŒìŠ¤íŠ¸ë²„ì „)</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      line-height: 1.6;
    }
    #checkin-status {
      white-space: pre-line;
      margin-top: 15px;
      font-size: 1.05rem;
      color: #333;
    }
    #checkinBtn {
      padding: 12px 22px;
      font-size: 1.1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background: #2c7be5;
      color: white;
    }
    #checkinBtn:disabled {
      background: gray;
      opacity: 0.5;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>ğŸ“ í…ŒìŠ¤íŠ¸ìš© GPS ì²´í¬ì¸ (í˜„ì¬ ìœ„ì¹˜ = í‰ì°½30ê¸¸ 27)</h1>
  <p>ê°€ë‚˜ì•„íŠ¸ì„¼í„° ë°˜ê²½ <b>50m</b> ì´ë‚´ì´ë©´ ì²´í¬ì¸ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>

  <p id="info">í˜„ì¬ ìœ„ì¹˜ë¥¼ ê³ ì •í•œ í…ŒìŠ¤íŠ¸ ë²„ì „ì…ë‹ˆë‹¤.</p>

  <!-- ì²´í¬ì¸ ë²„íŠ¼ -->
  <button id="checkinBtn">ì—¬ê¸°ì„œ ì²´í¬ì¸í•˜ê¸°</button>

  <div id="checkin-status"></div>

  <script>
    const statusEl = document.getElementById('checkin-status');
    const checkinBtn = document.getElementById('checkinBtn');

    // â­ ì²´í¬í¬ì¸íŠ¸: í‰ì°½ë™ ê°€ë‚˜ì•„íŠ¸ì„¼í„° (í™•ì •ëœ ì‚¬ì‹¤)
    const checkpoint = {
      name: "í‰ì°½ë™ ê°€ë‚˜ì•„íŠ¸ì„¼í„°",
      lat: 37.6122099878,
      lon: 126.9751811398,
      radiusM: 50
    };

    // â­ í˜„ì¬ ìœ„ì¹˜: ì„œìš¸ì‹œ í‰ì°½30ê¸¸ 27 (í…ŒìŠ¤íŠ¸ìš© ê³ ì • ì¢Œí‘œ)
    const currentPos = {
      latitude: 37.612210,
      longitude: 126.975181
    };

    function getDistance(lat1, lon1, lat2, lon2) {
      const R = 6371000;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a =
        Math.sin(dLat / 2) ** 2 +
        Math.cos(lat1 * Math.PI / 180) *
        Math.cos(lat2 * Math.PI / 180) *
        Math.sin(dLon / 2) ** 2;
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      return R * c;
    }

    // â­ ì²´í¬ì¸ ë²„íŠ¼
    checkinBtn.addEventListener("click", () => {
      const dist = getDistance(
        currentPos.latitude,
        currentPos.longitude,
        checkpoint.lat,
        checkpoint.lon
      );

      if (dist <= checkpoint.radiusM) {
        checkinBtn.disabled = true;
        statusEl.textContent =
          `âœ… ì²´í¬ì¸ ì„±ê³µ!\n` +
          `[${checkpoint.name}]\n` +
          `ê±°ë¦¬: ${dist.toFixed(1)} m`;
      } else {
        statusEl.textContent =
          `âŒ ì²´í¬ì¸ ì‹¤íŒ¨ (ë°˜ê²½ ë°–)\n` +
          `ê±°ë¦¬: ${dist.toFixed(1)} m`;
      }
    });

    // ì´ˆê¸° ê±°ë¦¬ ì•ˆë‚´
    const initialDistance = getDistance(
      currentPos.latitude,
      currentPos.longitude,
      checkpoint.lat,
      checkpoint.lon
    );

    statusEl.textContent =
      `ğŸ“ í˜„ì¬ ìœ„ì¹˜: ì„œìš¸ì‹œ í‰ì°½30ê¸¸ 27(ê³ ì •)\n` +
      `ğŸ“ ì²´í¬í¬ì¸íŠ¸: ${checkpoint.name}\n\n` +
      `í˜„ì¬ ê±°ë¦¬: ${initialDistance.toFixed(1)} m`;
  </script>
</body>
</html>
