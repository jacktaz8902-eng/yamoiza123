<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>GPS ì²´í¬ì¸ - ê°€ë‚˜ì•„íŠ¸ì„¼í„° + í™ì œì—­ (í…ŒìŠ¤íŠ¸)</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      line-height: 1.6;
    }
    #checkin-status {
      white-space: pre-line;
      margin-top: 15px;
      font-size: 1.05rem;
      color: #333;
    }
    #checkinBtn {
      padding: 12px 22px;
      font-size: 1.1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background: #2c7be5;
      color: white;
    }
    #checkinBtn:disabled {
      background: gray;
      opacity: 0.5;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>ğŸ“ í…ŒìŠ¤íŠ¸ìš© GPS ì²´í¬ì¸</h1>
  <p>
    í˜„ì¬ ìœ„ì¹˜ëŠ” <b>ì„œìš¸ì‹œ í‰ì°½30ê¸¸ 27(ê³ ì •)</b>ìœ¼ë¡œ ê°€ì •í•˜ê³ ,<br />
    ë‹¤ìŒ ë‘ ê³³ ì¤‘ ë°˜ê²½ <b>50m</b> ì´ë‚´ì— ìˆìœ¼ë©´ ì²´í¬ì¸ì´ ë©ë‹ˆë‹¤.
  </p>
  <ul>
    <li>ì²´í¬í¬ì¸íŠ¸ 1: í‰ì°½ë™ ê°€ë‚˜ì•„íŠ¸ì„¼í„°</li>
    <li>ì²´í¬í¬ì¸íŠ¸ 2: í™ì œì—­ (ì„œìš¸ ì§€í•˜ì²  3í˜¸ì„ )</li>
  </ul>

  <button id="checkinBtn">ì—¬ê¸°ì„œ ì²´í¬ì¸í•˜ê¸°</button>

  <div id="checkin-status"></div>

  <script>
    const statusEl = document.getElementById('checkin-status');
    const checkinBtn = document.getElementById('checkinBtn');

    // âœ… ì²´í¬í¬ì¸íŠ¸ë“¤: ê°€ë‚˜ì•„íŠ¸ì„¼í„° + í™ì œì—­
    const checkpoints = [
      {
        id: 1,
        name: "í‰ì°½ë™ ê°€ë‚˜ì•„íŠ¸ì„¼í„°",
        lat: 37.6122099878,
        lon: 126.9751811398,
        radiusM: 50
      },
      {
        id: 2,
        name: "í™ì œì—­ (ì§€í•˜ì²  3í˜¸ì„ )",
        lat: 37.5887974,
        lon: 126.94411,
        radiusM: 50
      }
    ];

    // âœ… í˜„ì¬ ìœ„ì¹˜: ì„œìš¸ì‹œ í‰ì°½30ê¸¸ 27 (í…ŒìŠ¤íŠ¸ìš© ê³ ì • ì¢Œí‘œ)
    const currentPos = {
      latitude: 37.612210,
      longitude: 126.975181
    };

    function getDistance(lat1, lon1, lat2, lon2) {
      const R = 6371000;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a =
        Math.sin(dLat / 2) ** 2 +
        Math.cos(lat1 * Math.PI / 180) *
        Math.cos(lat2 * Math.PI / 180) *
        Math.sin(dLon / 2) ** 2;
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      return R * c;
    }

    // ì´ˆê¸° ìƒíƒœ: ê° ì²´í¬í¬ì¸íŠ¸ê¹Œì§€ ê±°ë¦¬ ë³´ì—¬ì£¼ê¸°
    function renderInitialDistances() {
      const lines = [];
      checkpoints.forEach(cp => {
        const dist = getDistance(
          currentPos.latitude,
          currentPos.longitude,
          cp.lat,
          cp.lon
        );
        lines.push(
          `ğŸ“ [${cp.name}] ê¹Œì§€ ê±°ë¦¬: ${dist.toFixed(1)} m (ë°˜ê²½ ${cp.radiusM} m)`
        );
      });

      statusEl.textContent =
        `í˜„ì¬ ìœ„ì¹˜: ì„œìš¸ì‹œ í‰ì°½30ê¸¸ 27 (ê³ ì •)\n\n` +
        lines.join("\n");
    }

    renderInitialDistances();

    // ì²´í¬ì¸ ë²„íŠ¼ ë¡œì§
    checkinBtn.addEventListener("click", () => {
      let successCheckpoint = null;
      let messages = [];

      checkpoints.forEach(cp => {
        const dist = getDistance(
          currentPos.latitude,
          currentPos.longitude,
          cp.lat,
          cp.lon
        );
        if (dist <= cp.radiusM && !successCheckpoint) {
          successCheckpoint = { ...cp, dist };
        }
        messages.push(
          `- [${cp.name}] ê¹Œì§€ ê±°ë¦¬: ${dist.toFixed(1)} m (ë°˜ê²½ ${cp.radiusM} m)`
        );
      });

      if (successCheckpoint) {
        checkinBtn.disabled = true;
        statusEl.textContent =
          `âœ… ì²´í¬ì¸ ì„±ê³µ!\n` +
          `ì²´í¬í¬ì¸íŠ¸: ${successCheckpoint.name}\n` +
          `ê±°ë¦¬: ${successCheckpoint.dist.toFixed(1)} m\n\n` +
          messages.join("\n");
      } else {
        statusEl.textContent =
          `âŒ ì²´í¬ì¸ ì‹¤íŒ¨ (ë‘ ì²´í¬í¬ì¸íŠ¸ ëª¨ë‘ ë°˜ê²½ ë°–)\n\n` +
          messages.join("\n");
      }
    });
  </script>
</body>
</html>

